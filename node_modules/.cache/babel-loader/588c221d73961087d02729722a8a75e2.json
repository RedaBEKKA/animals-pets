{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\BigNova-Projects\\\\BigNova-Pets Animals\\\\animals-pets\\\\src\\\\pages\\\\MyProductPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Checkbox, makeStyles } from \"@material-ui/core\";\nimport { Header, Title } from \"../components\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport MUIDataTable from \"mui-datatables\";\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport { colors } from \"../themes/colors\";\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Modal from 'react-modal';\nimport { Link, Redirect } from 'react-router-dom';\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core/styles';\nimport misterCoockyApi from '../constante/apiUrl';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst customStyles = {\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)'\n  }\n};\n\nconst getMuiTheme = () => createMuiTheme({\n  overrides: {\n    MuiTableHead: {\n      root: {\n        position: 'sticky'\n      }\n    }\n  }\n});\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1\n  },\n  btn: {\n    padding: theme.spacing(2),\n    color: theme.palette.text.secondary,\n    width: '100%',\n    height: '0px'\n  }\n}));\n/**\r\n * Page d'affichage des Produits de l'utilisateur\r\n * @returns {*}\r\n * @constructor\r\n */\n\nfunction MyProductPage() {\n  _s();\n\n  const [data, setData] = useState([]); //produits de l'utilisateur\n\n  const [selectedItemId, setSelectedItemId] = useState(false); //produits de l'utilisateur\n\n  const [selectedItemIdToDelete, setSelectedItemIdToDelete] = useState(null); //produits de l'utilisateur\n\n  const classes = useStyles();\n\n  function arrangeParameters(arr) {\n    var items = [];\n    arr.forEach(i => {\n      items.push({\n        'product': i.product.name,\n        'mark': i.mark.name,\n        'ttcPrice': Math.round(i.ttcPrice / (1 - Math.abs(i.discount / 100))),\n        'pet': i.pet.name,\n        'offer': i.offer.name,\n        'category': i.category.name,\n        'discount': i.discount,\n        'isSmart': i.isSmart,\n        'isHealthy': i.isHealthy,\n        'isResponsible': i.isResponsible,\n        'img': i.uri,\n        'id': i.id,\n        'priceDeducted': i.ttcPrice\n      });\n    });\n    setData(items);\n  }\n\n  const options = {\n    selectableRows: false,\n    customHeadRender: {\n      position: 'absolute'\n    },\n    textLabels: {\n      body: {\n        noMatch: 'Aucun produit trouvé'\n      },\n      pagination: {\n        next: \"Page suivante\",\n        previous: \"Page précédente\",\n        rowsPerPage: \"Produits par page:\",\n        displayRows: \"sur\"\n      }\n    }\n  };\n  const columns = [{\n    name: \"img\",\n    label: \"Image\",\n    options: {\n      customBodyRender: function (data) {\n        if (data) {\n          const dataImg = \"data:image/png;base64,\" + data;\n          return /*#__PURE__*/_jsxDEV(\"img\", {\n            src: dataImg,\n            width: 80\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 32\n          }, this);\n        } else return 'N/A';\n      }\n    }\n  }, {\n    name: \"product\",\n    label: \"Nom\"\n  }, {\n    name: \"mark\",\n    label: \"Marque\"\n  }, {\n    name: \"ttcPrice\",\n    label: \"Prix (€)\"\n  }, {\n    name: \"discount\",\n    label: \"Discount (%)\"\n  }, {\n    name: \"priceDeducted\",\n    label: \"Prix affiché (€)\"\n  }, {\n    name: \"pet\",\n    label: \"Animal\"\n  }, {\n    name: \"offer\",\n    label: \"Type de produit\"\n  }, {\n    name: \"category\",\n    label: \"Catégorie\"\n  }, {\n    name: \"isHealthy\",\n    label: \"Sain\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"isSmart\",\n    label: \"Malin\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"isResponsible\",\n    label: \"Responsable\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"id\",\n    label: \"Actions\",\n    options: {\n      customBodyRender: function (res) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Editer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => setSelectedItemId(res),\n            children: /*#__PURE__*/_jsxDEV(EditOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Supprimer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => setSelectedItemIdToDelete(res),\n            children: /*#__PURE__*/_jsxDEV(DeleteOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }];\n  useEffect(() => {\n    refreshList();\n  }, []);\n  /**\r\n   * Suppression de l'item sélectionné\r\n   * @param id\r\n   */\n\n  function deleteItem(id) {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    mutation DeleteItemById($id: String!) {\n                      deleteItemById(id: $id)\n                    }`,\n        variables: {\n          \"id\": id\n        }\n      })\n    }).then(res => res.json()).then(function (result) {\n      refreshList();\n      setSelectedItemIdToDelete(null);\n    });\n  }\n  /**\r\n   * Récupération des produits\r\n   */\n\n\n  function refreshList() {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    query{​​​​​​​\n                        getItemsBySupplierId(id:\"${localStorage.getItem('supplierId')}\"){​​​​​​​\n                            product{\n                                name\n                            }\n                            mark{\n                                name\n                            }\n                            ttcPrice\n                            discount\n                            pet{\n                                name\n                            }\n                            offer{\n                                name\n                            }\n                            category{\n                                name\n                            }\n                            subCategories{\n                                name\n                            }\n                            isHealthy\n                            isResponsible\n                            isSmart\n                            uri\n                            id\n                          }​​​​​​​\n                    }`\n      })\n    }).then(res => res.json()).then(function (result) {\n      arrangeParameters(result.data.getItemsBySupplierId);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [selectedItemId ? /*#__PURE__*/_jsxDEV(Redirect, {\n      to: {\n        pathname: \"/addProduct\",\n        state: {\n          itemId: selectedItemId\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 21\n    }, this) : null, /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(Modal, {\n        isOpen: selectedItemIdToDelete !== null,\n        onRequestClose: () => setSelectedItemIdToDelete(null),\n        style: customStyles,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: \"Etes vous s\\xFBr de vouloir supprimer l'article?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => deleteItem(selectedItemIdToDelete),\n          children: \"Oui\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setSelectedItemIdToDelete(null),\n          children: \"Non\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Title, {\n        name: \"SMR — Produits\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 5,\n        justify: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/products\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.brown\n            },\n            children: \"Produits ajout\\xE9s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/addproduct\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Ajout d'un produit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/statistics\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Statistiques\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        mt: 5,\n        children: /*#__PURE__*/_jsxDEV(MuiThemeProvider, {\n          theme: getMuiTheme(),\n          children: /*#__PURE__*/_jsxDEV(MUIDataTable, {\n            title: \"Produits\",\n            data: data,\n            columns: columns,\n            options: options\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 276,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyProductPage, \"73fO3RRj/k1jwrCR2yDLnsdhUfA=\", false, function () {\n  return [useStyles];\n});\n\n_c = MyProductPage;\nexport default MyProductPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyProductPage\");","map":{"version":3,"sources":["C:/Users/PC/Desktop/BigNova-Projects/BigNova-Pets Animals/animals-pets/src/pages/MyProductPage.js"],"names":["React","useEffect","useState","Checkbox","makeStyles","Header","Title","Container","Grid","MUIDataTable","Button","Box","colors","DeleteOutlinedIcon","EditOutlinedIcon","IconButton","Modal","Link","Redirect","createMuiTheme","MuiThemeProvider","misterCoockyApi","customStyles","content","top","left","right","bottom","marginRight","transform","getMuiTheme","overrides","MuiTableHead","root","position","useStyles","theme","flexGrow","btn","padding","spacing","color","palette","text","secondary","width","height","MyProductPage","data","setData","selectedItemId","setSelectedItemId","selectedItemIdToDelete","setSelectedItemIdToDelete","classes","arrangeParameters","arr","items","forEach","i","push","product","name","mark","Math","round","ttcPrice","abs","discount","pet","offer","category","isSmart","isHealthy","isResponsible","uri","id","options","selectableRows","customHeadRender","textLabels","body","noMatch","pagination","next","previous","rowsPerPage","displayRows","columns","label","customBodyRender","dataImg","res","grey","refreshList","deleteItem","fetch","method","headers","JSON","stringify","query","variables","then","json","result","localStorage","getItem","getItemsBySupplierId","pathname","state","itemId","backgroundColor","brown"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport {Checkbox, makeStyles} from \"@material-ui/core\";\r\nimport {Header, Title} from \"../components\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport MUIDataTable from \"mui-datatables\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {colors} from \"../themes/colors\";\r\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\r\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Modal from 'react-modal';\r\nimport {Link, Redirect} from 'react-router-dom';\r\nimport {createMuiTheme, MuiThemeProvider} from '@material-ui/core/styles';\r\nimport misterCoockyApi from '../constante/apiUrl'\r\n\r\nconst customStyles = {\r\n    content: {\r\n        top: '50%',\r\n        left: '50%',\r\n        right: 'auto',\r\n        bottom: 'auto',\r\n        marginRight: '-50%',\r\n        transform: 'translate(-50%, -50%)',\r\n    },\r\n};\r\n\r\n\r\nconst getMuiTheme = () => createMuiTheme({\r\n    overrides: {\r\n        MuiTableHead: {\r\n            root: {\r\n                position: 'sticky'\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        flexGrow: 1,\r\n    },\r\n    btn: {\r\n        padding: theme.spacing(2),\r\n        color: theme.palette.text.secondary,\r\n        width: '100%',\r\n        height: '0px',\r\n    },\r\n\r\n}));\r\n\r\n/**\r\n * Page d'affichage des Produits de l'utilisateur\r\n * @returns {*}\r\n * @constructor\r\n */\r\nfunction MyProductPage() {\r\n    const [data, setData] = useState([]);   //produits de l'utilisateur\r\n    const [selectedItemId, setSelectedItemId] = useState(false);   //produits de l'utilisateur\r\n    const [selectedItemIdToDelete, setSelectedItemIdToDelete] = useState(null);   //produits de l'utilisateur\r\n    const classes = useStyles();\r\n\r\n    function arrangeParameters(arr) {\r\n        var items = [];\r\n        arr.forEach(i => {\r\n            items.push({\r\n                'product': i.product.name,\r\n                'mark': i.mark.name,\r\n                'ttcPrice': Math.round(i.ttcPrice/(1-Math.abs(i.discount/100))),\r\n                'pet': i.pet.name,\r\n                'offer': i.offer.name,\r\n                'category': i.category.name,\r\n                'discount': i.discount,\r\n                'isSmart': i.isSmart,\r\n                'isHealthy': i.isHealthy,\r\n                'isResponsible': i.isResponsible,\r\n                'img': i.uri,\r\n                'id': i.id,\r\n                'priceDeducted': i.ttcPrice\r\n            })\r\n        });\r\n        setData(items)\r\n    }\r\n    const options = {\r\n        selectableRows: false,\r\n        customHeadRender: {\r\n            position: 'absolute'\r\n        },\r\n        textLabels: {\r\n            body: {\r\n                noMatch: 'Aucun produit trouvé'\r\n            },\r\n            pagination: {\r\n                next: \"Page suivante\",\r\n                previous: \"Page précédente\",\r\n                rowsPerPage: \"Produits par page:\",\r\n                displayRows: \"sur\",\r\n            },\r\n        }\r\n    };\r\n    const columns = [\r\n        {\r\n            name: \"img\",\r\n            label: \"Image\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    if (data) {\r\n                        const dataImg = \"data:image/png;base64,\" + data;\r\n                        return <img src={dataImg} width={80}/>;\r\n                    } else return 'N/A'\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"product\",\r\n            label: \"Nom\"\r\n        },\r\n        {\r\n            name: \"mark\",\r\n            label: \"Marque\"\r\n        },\r\n        {\r\n            name: \"ttcPrice\",\r\n            label: \"Prix (€)\"\r\n        },\r\n        {\r\n            name: \"discount\",\r\n            label: \"Discount (%)\"\r\n        },\r\n        {\r\n            name: \"priceDeducted\",\r\n            label: \"Prix affiché (€)\"\r\n        },\r\n        {\r\n            name: \"pet\",\r\n            label: \"Animal\"\r\n        },\r\n        {\r\n            name: \"offer\",\r\n            label: \"Type de produit\"\r\n        },\r\n        {\r\n            name: \"category\",\r\n            label: \"Catégorie\"\r\n        },\r\n        {\r\n            name: \"isHealthy\",\r\n            label: \"Sain\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"isSmart\",\r\n            label: \"Malin\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"isResponsible\",\r\n            label: \"Responsable\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"id\",\r\n            label: \"Actions\",\r\n            options: {\r\n                customBodyRender: function (res) {\r\n                    return <div>\r\n                        <IconButton aria-label=\"Editer\" style={{padding: \"3px\"}} onClick={() => setSelectedItemId(res)}>\r\n                            <EditOutlinedIcon style={{color: colors.grey}}/>\r\n                        </IconButton>\r\n                        <IconButton aria-label=\"Supprimer\" style={{padding: \"3px\"}}\r\n                                    onClick={() => setSelectedItemIdToDelete(res)}>\r\n                            <DeleteOutlinedIcon style={{color: colors.grey}}/>\r\n                        </IconButton>\r\n                    </div>\r\n                }\r\n            }\r\n        },\r\n\r\n    ];\r\n\r\n    useEffect(() => {\r\n        refreshList()\r\n    }, []);\r\n\r\n\r\n    /**\r\n     * Suppression de l'item sélectionné\r\n     * @param id\r\n     */\r\n    function deleteItem(id) {\r\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                query: `\r\n                    mutation DeleteItemById($id: String!) {\r\n                      deleteItemById(id: $id)\r\n                    }`,\r\n                variables: {\r\n                    \"id\": id\r\n                }\r\n            }),\r\n        })\r\n            .then((res) => res.json())\r\n            .then(function (result) {\r\n                refreshList();\r\n                setSelectedItemIdToDelete(null)\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Récupération des produits\r\n     */\r\n    function refreshList() {\r\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                query: `\r\n                    query{​​​​​​​\r\n                        getItemsBySupplierId(id:\"${localStorage.getItem('supplierId')}\"){​​​​​​​\r\n                            product{\r\n                                name\r\n                            }\r\n                            mark{\r\n                                name\r\n                            }\r\n                            ttcPrice\r\n                            discount\r\n                            pet{\r\n                                name\r\n                            }\r\n                            offer{\r\n                                name\r\n                            }\r\n                            category{\r\n                                name\r\n                            }\r\n                            subCategories{\r\n                                name\r\n                            }\r\n                            isHealthy\r\n                            isResponsible\r\n                            isSmart\r\n                            uri\r\n                            id\r\n                          }​​​​​​​\r\n                    }`,\r\n            }),\r\n        })\r\n            .then((res) => res.json())\r\n            .then(function (result) {\r\n                arrangeParameters(result.data.getItemsBySupplierId);\r\n            })\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                selectedItemId ?\r\n                    <Redirect\r\n                        to={{\r\n                            pathname: \"/addProduct\",\r\n                            state: {itemId: selectedItemId}\r\n                        }}\r\n                    />\r\n                    : null\r\n            }\r\n            <Header/>\r\n            <Container>\r\n                <Modal\r\n                    isOpen={selectedItemIdToDelete !== null}\r\n                    onRequestClose={() => setSelectedItemIdToDelete(null)}\r\n                    style={customStyles}\r\n                >\r\n                    <Grid>Etes vous sûr de vouloir supprimer l'article?</Grid>\r\n                    <Button onClick={() => deleteItem(selectedItemIdToDelete)}>Oui</Button>\r\n                    <Button onClick={() => setSelectedItemIdToDelete(null)}>Non</Button>\r\n                </Modal>\r\n                <Title name={\"SMR — Produits\"}/>\r\n                <Grid container spacing={5} justify=\"center\">\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/products\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.brown}}>Produits ajoutés</Button>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/addproduct\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.grey}}>Ajout d'un produit</Button>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/statistics\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.grey}}>Statistiques</Button>\r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <Box mt={5}>\r\n                    <MuiThemeProvider theme={getMuiTheme()}>\r\n                        <MUIDataTable\r\n                            title={\"Produits\"}\r\n                            data={data}\r\n                            columns={columns}\r\n                            options={options}\r\n                        />\r\n                    </MuiThemeProvider>\r\n                </Box>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MyProductPage\r\n"]},"metadata":{},"sourceType":"module"}