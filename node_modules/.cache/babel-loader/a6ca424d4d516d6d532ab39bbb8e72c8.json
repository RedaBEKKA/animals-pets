{"ast":null,"code":"var _jsxFileName = \"/media/reda/F4C8104CC810100A/Project/React-RN/animals-pets/src/pages/MyProductPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Checkbox, makeStyles } from \"@material-ui/core\";\nimport { Header, Title } from \"../components\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport MUIDataTable from \"mui-datatables\";\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport { colors } from \"../themes/colors\";\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Modal from 'react-modal';\nimport { Link, Redirect } from 'react-router-dom';\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core/styles';\nimport misterCoockyApi from '../constante/apiUrl';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst customStyles = {\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)'\n  }\n};\n\nconst getMuiTheme = () => createMuiTheme({\n  overrides: {\n    MuiTableHead: {\n      root: {\n        position: 'sticky'\n      }\n    }\n  }\n});\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1\n  },\n  btn: {\n    padding: theme.spacing(2),\n    color: theme.palette.text.secondary,\n    width: '100%',\n    height: '0px'\n  }\n}));\n/**\n * Page d'affichage des Produits de l'utilisateur\n * @returns {*}\n * @constructor\n */\n\nfunction MyProductPage() {\n  _s();\n\n  const [data, setData] = useState([]); //produits de l'utilisateur\n\n  const [selectedItemId, setSelectedItemId] = useState(false); //produits de l'utilisateur\n\n  const [selectedItemIdToDelete, setSelectedItemIdToDelete] = useState(null); //produits de l'utilisateur\n\n  const classes = useStyles();\n\n  function arrangeParameters(arr) {\n    var items = [];\n    arr.forEach(i => {\n      items.push({\n        'product': i.product.name,\n        'mark': i.mark.name,\n        'ttcPrice': Math.round(i.ttcPrice / (1 - Math.abs(i.discount / 100))),\n        'pet': i.pet.name,\n        'offer': i.offer.name,\n        'category': i.category.name,\n        'discount': i.discount,\n        'isSmart': i.isSmart,\n        'isHealthy': i.isHealthy,\n        'isResponsible': i.isResponsible,\n        'img': i.uri,\n        'id': i.id,\n        'priceDeducted': i.ttcPrice\n      });\n    });\n    setData(items);\n  }\n\n  const options = {\n    selectableRows: false,\n    customHeadRender: {\n      position: 'absolute'\n    },\n    textLabels: {\n      body: {\n        noMatch: 'Aucun produit trouvé'\n      },\n      pagination: {\n        next: \"Page suivante\",\n        previous: \"Page précédente\",\n        rowsPerPage: \"Produits par page:\",\n        displayRows: \"sur\"\n      }\n    }\n  };\n  const columns = [{\n    name: \"img\",\n    label: \"Image\",\n    options: {\n      customBodyRender: function (data) {\n        if (data) {\n          const dataImg = \"data:image/png;base64,\" + data;\n          return /*#__PURE__*/_jsxDEV(\"img\", {\n            src: dataImg,\n            width: 80\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 32\n          }, this);\n        } else return 'N/A';\n      }\n    }\n  }, {\n    name: \"product\",\n    label: \"Nom\"\n  }, {\n    name: \"mark\",\n    label: \"Marque\"\n  }, {\n    name: \"ttcPrice\",\n    label: \"Prix (€)\"\n  }, {\n    name: \"discount\",\n    label: \"Discount (%)\"\n  }, {\n    name: \"priceDeducted\",\n    label: \"Prix affiché (€)\"\n  }, {\n    name: \"pet\",\n    label: \"Animal\"\n  }, {\n    name: \"offer\",\n    label: \"Type de produit\"\n  }, {\n    name: \"category\",\n    label: \"Catégorie\"\n  }, {\n    name: \"isHealthy\",\n    label: \"Sain\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"isSmart\",\n    label: \"Malin\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"isResponsible\",\n    label: \"Responsable\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"id\",\n    label: \"Actions\",\n    options: {\n      customBodyRender: function (res) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Editer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => setSelectedItemId(res),\n            children: /*#__PURE__*/_jsxDEV(EditOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Supprimer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => setSelectedItemIdToDelete(res),\n            children: /*#__PURE__*/_jsxDEV(DeleteOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }];\n  useEffect(() => {\n    refreshList();\n  }, []);\n  /**\n   * Suppression de l'item sélectionné\n   * @param id\n   */\n\n  function deleteItem(id) {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    mutation DeleteItemById($id: String!) {\n                      deleteItemById(id: $id)\n                    }`,\n        variables: {\n          \"id\": id\n        }\n      })\n    }).then(res => res.json()).then(function (result) {\n      refreshList();\n      setSelectedItemIdToDelete(null);\n    });\n  }\n  /**\n   * Récupération des produits\n   */\n\n\n  function refreshList() {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    query{​​​​​​​\n                        getItemsBySupplierId(id:\"${localStorage.getItem('supplierId')}\"){​​​​​​​\n                            product{\n                                name\n                            }\n                            mark{\n                                name\n                            }\n                            ttcPrice\n                            discount\n                            pet{\n                                name\n                            }\n                            offer{\n                                name\n                            }\n                            category{\n                                name\n                            }\n                            subCategories{\n                                name\n                            }\n                            isHealthy\n                            isResponsible\n                            isSmart\n                            uri\n                            id\n                          }​​​​​​​\n                    }`\n      })\n    }).then(res => res.json()).then(function (result) {\n      arrangeParameters(result.data.getItemsBySupplierId);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [selectedItemId ? /*#__PURE__*/_jsxDEV(Redirect, {\n      to: {\n        pathname: \"/addProduct\",\n        state: {\n          itemId: selectedItemId\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 21\n    }, this) : null, /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(Modal, {\n        isOpen: selectedItemIdToDelete !== null,\n        onRequestClose: () => setSelectedItemIdToDelete(null),\n        style: customStyles,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: \"Etes vous s\\xFBr de vouloir supprimer l'article?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => deleteItem(selectedItemIdToDelete),\n          children: \"Oui\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setSelectedItemIdToDelete(null),\n          children: \"Non\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Title, {\n        name: \"SMR — Produits\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 5,\n        justify: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/products\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.brown\n            },\n            children: \"Produits ajout\\xE9s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/addproduct\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Ajout d'un produit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/statistics\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Statistiques\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        mt: 5,\n        children: /*#__PURE__*/_jsxDEV(MuiThemeProvider, {\n          theme: getMuiTheme(),\n          children: /*#__PURE__*/_jsxDEV(MUIDataTable, {\n            title: \"Produits\",\n            data: data,\n            columns: columns,\n            options: options\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 276,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyProductPage, \"73fO3RRj/k1jwrCR2yDLnsdhUfA=\", false, function () {\n  return [useStyles];\n});\n\n_c = MyProductPage;\nexport default MyProductPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyProductPage\");","map":{"version":3,"sources":["/media/reda/F4C8104CC810100A/Project/React-RN/animals-pets/src/pages/MyProductPage.js"],"names":["React","useEffect","useState","Checkbox","makeStyles","Header","Title","Container","Grid","MUIDataTable","Button","Box","colors","DeleteOutlinedIcon","EditOutlinedIcon","IconButton","Modal","Link","Redirect","createMuiTheme","MuiThemeProvider","misterCoockyApi","customStyles","content","top","left","right","bottom","marginRight","transform","getMuiTheme","overrides","MuiTableHead","root","position","useStyles","theme","flexGrow","btn","padding","spacing","color","palette","text","secondary","width","height","MyProductPage","data","setData","selectedItemId","setSelectedItemId","selectedItemIdToDelete","setSelectedItemIdToDelete","classes","arrangeParameters","arr","items","forEach","i","push","product","name","mark","Math","round","ttcPrice","abs","discount","pet","offer","category","isSmart","isHealthy","isResponsible","uri","id","options","selectableRows","customHeadRender","textLabels","body","noMatch","pagination","next","previous","rowsPerPage","displayRows","columns","label","customBodyRender","dataImg","res","grey","refreshList","deleteItem","fetch","method","headers","JSON","stringify","query","variables","then","json","result","localStorage","getItem","getItemsBySupplierId","pathname","state","itemId","backgroundColor","brown"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {Checkbox, makeStyles} from \"@material-ui/core\";\nimport {Header, Title} from \"../components\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport MUIDataTable from \"mui-datatables\";\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport {colors} from \"../themes/colors\";\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Modal from 'react-modal';\nimport {Link, Redirect} from 'react-router-dom';\nimport {createMuiTheme, MuiThemeProvider} from '@material-ui/core/styles';\nimport misterCoockyApi from '../constante/apiUrl'\n\nconst customStyles = {\n    content: {\n        top: '50%',\n        left: '50%',\n        right: 'auto',\n        bottom: 'auto',\n        marginRight: '-50%',\n        transform: 'translate(-50%, -50%)',\n    },\n};\n\n\nconst getMuiTheme = () => createMuiTheme({\n    overrides: {\n        MuiTableHead: {\n            root: {\n                position: 'sticky'\n            }\n        }\n    }\n});\n\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    btn: {\n        padding: theme.spacing(2),\n        color: theme.palette.text.secondary,\n        width: '100%',\n        height: '0px',\n    },\n\n}));\n\n/**\n * Page d'affichage des Produits de l'utilisateur\n * @returns {*}\n * @constructor\n */\nfunction MyProductPage() {\n    const [data, setData] = useState([]);   //produits de l'utilisateur\n    const [selectedItemId, setSelectedItemId] = useState(false);   //produits de l'utilisateur\n    const [selectedItemIdToDelete, setSelectedItemIdToDelete] = useState(null);   //produits de l'utilisateur\n    const classes = useStyles();\n\n    function arrangeParameters(arr) {\n        var items = [];\n        arr.forEach(i => {\n            items.push({\n                'product': i.product.name,\n                'mark': i.mark.name,\n                'ttcPrice': Math.round(i.ttcPrice/(1-Math.abs(i.discount/100))),\n                'pet': i.pet.name,\n                'offer': i.offer.name,\n                'category': i.category.name,\n                'discount': i.discount,\n                'isSmart': i.isSmart,\n                'isHealthy': i.isHealthy,\n                'isResponsible': i.isResponsible,\n                'img': i.uri,\n                'id': i.id,\n                'priceDeducted': i.ttcPrice\n            })\n        });\n        setData(items)\n    }\n    const options = {\n        selectableRows: false,\n        customHeadRender: {\n            position: 'absolute'\n        },\n        textLabels: {\n            body: {\n                noMatch: 'Aucun produit trouvé'\n            },\n            pagination: {\n                next: \"Page suivante\",\n                previous: \"Page précédente\",\n                rowsPerPage: \"Produits par page:\",\n                displayRows: \"sur\",\n            },\n        }\n    };\n    const columns = [\n        {\n            name: \"img\",\n            label: \"Image\",\n            options: {\n                customBodyRender: function (data) {\n                    if (data) {\n                        const dataImg = \"data:image/png;base64,\" + data;\n                        return <img src={dataImg} width={80}/>;\n                    } else return 'N/A'\n                }\n            }\n        },\n        {\n            name: \"product\",\n            label: \"Nom\"\n        },\n        {\n            name: \"mark\",\n            label: \"Marque\"\n        },\n        {\n            name: \"ttcPrice\",\n            label: \"Prix (€)\"\n        },\n        {\n            name: \"discount\",\n            label: \"Discount (%)\"\n        },\n        {\n            name: \"priceDeducted\",\n            label: \"Prix affiché (€)\"\n        },\n        {\n            name: \"pet\",\n            label: \"Animal\"\n        },\n        {\n            name: \"offer\",\n            label: \"Type de produit\"\n        },\n        {\n            name: \"category\",\n            label: \"Catégorie\"\n        },\n        {\n            name: \"isHealthy\",\n            label: \"Sain\",\n            options: {\n                customBodyRender: function (data) {\n                    return <Checkbox checked={data} disabled={true}/>;\n                }\n            }\n        },\n        {\n            name: \"isSmart\",\n            label: \"Malin\",\n            options: {\n                customBodyRender: function (data) {\n                    return <Checkbox checked={data} disabled={true}/>;\n                }\n            }\n        },\n        {\n            name: \"isResponsible\",\n            label: \"Responsable\",\n            options: {\n                customBodyRender: function (data) {\n                    return <Checkbox checked={data} disabled={true}/>;\n                }\n            }\n        },\n        {\n            name: \"id\",\n            label: \"Actions\",\n            options: {\n                customBodyRender: function (res) {\n                    return <div>\n                        <IconButton aria-label=\"Editer\" style={{padding: \"3px\"}} onClick={() => setSelectedItemId(res)}>\n                            <EditOutlinedIcon style={{color: colors.grey}}/>\n                        </IconButton>\n                        <IconButton aria-label=\"Supprimer\" style={{padding: \"3px\"}}\n                                    onClick={() => setSelectedItemIdToDelete(res)}>\n                            <DeleteOutlinedIcon style={{color: colors.grey}}/>\n                        </IconButton>\n                    </div>\n                }\n            }\n        },\n\n    ];\n\n    useEffect(() => {\n        refreshList()\n    }, []);\n\n\n    /**\n     * Suppression de l'item sélectionné\n     * @param id\n     */\n    function deleteItem(id) {\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                query: `\n                    mutation DeleteItemById($id: String!) {\n                      deleteItemById(id: $id)\n                    }`,\n                variables: {\n                    \"id\": id\n                }\n            }),\n        })\n            .then((res) => res.json())\n            .then(function (result) {\n                refreshList();\n                setSelectedItemIdToDelete(null)\n            });\n    }\n\n    /**\n     * Récupération des produits\n     */\n    function refreshList() {\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                query: `\n                    query{​​​​​​​\n                        getItemsBySupplierId(id:\"${localStorage.getItem('supplierId')}\"){​​​​​​​\n                            product{\n                                name\n                            }\n                            mark{\n                                name\n                            }\n                            ttcPrice\n                            discount\n                            pet{\n                                name\n                            }\n                            offer{\n                                name\n                            }\n                            category{\n                                name\n                            }\n                            subCategories{\n                                name\n                            }\n                            isHealthy\n                            isResponsible\n                            isSmart\n                            uri\n                            id\n                          }​​​​​​​\n                    }`,\n            }),\n        })\n            .then((res) => res.json())\n            .then(function (result) {\n                arrangeParameters(result.data.getItemsBySupplierId);\n            })\n    }\n\n    return (\n        <div>\n            {\n                selectedItemId ?\n                    <Redirect\n                        to={{\n                            pathname: \"/addProduct\",\n                            state: {itemId: selectedItemId}\n                        }}\n                    />\n                    : null\n            }\n            <Header/>\n            <Container>\n                <Modal\n                    isOpen={selectedItemIdToDelete !== null}\n                    onRequestClose={() => setSelectedItemIdToDelete(null)}\n                    style={customStyles}\n                >\n                    <Grid>Etes vous sûr de vouloir supprimer l'article?</Grid>\n                    <Button onClick={() => deleteItem(selectedItemIdToDelete)}>Oui</Button>\n                    <Button onClick={() => setSelectedItemIdToDelete(null)}>Non</Button>\n                </Modal>\n                <Title name={\"SMR — Produits\"}/>\n                <Grid container spacing={5} justify=\"center\">\n                    <Grid item xs={12} sm={3}>\n                        <Button component={Link} to=\"/products\" className={classes.btn} variant=\"contained\"\n                                style={{backgroundColor: colors.brown}}>Produits ajoutés</Button>\n                    </Grid>\n\n                    <Grid item xs={12} sm={3}>\n                        <Button component={Link} to=\"/addproduct\" className={classes.btn} variant=\"contained\"\n                                style={{backgroundColor: colors.grey}}>Ajout d'un produit</Button>\n                    </Grid>\n                    <Grid item xs={12} sm={3}>\n                        <Button component={Link} to=\"/statistics\" className={classes.btn} variant=\"contained\"\n                                style={{backgroundColor: colors.grey}}>Statistiques</Button>\n                    </Grid>\n                </Grid>\n\n                <Box mt={5}>\n                    <MuiThemeProvider theme={getMuiTheme()}>\n                        <MUIDataTable\n                            title={\"Produits\"}\n                            data={data}\n                            columns={columns}\n                            options={options}\n                        />\n                    </MuiThemeProvider>\n                </Box>\n            </Container>\n        </div>\n    )\n}\n\nexport default MyProductPage\n"]},"metadata":{},"sourceType":"module"}