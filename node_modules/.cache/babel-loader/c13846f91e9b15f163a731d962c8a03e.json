{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\BigNova-Projects\\\\Project - 12 - BigNova-Pets Animals-web\\\\ClonedFromGitHub\\\\animals-pets\\\\src\\\\pages\\\\MyAnnoncesPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Checkbox, makeStyles } from \"@material-ui/core\";\nimport { Header, Title } from \"../components\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport MUIDataTable from \"mui-datatables\";\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport { colors } from \"../themes/colors\";\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core/styles';\nimport { Link, Redirect } from 'react-router-dom';\nimport Modal from 'react-modal';\nimport misterCoockyApi from '../constante/apiUrl';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1\n  },\n  btn: {\n    padding: theme.spacing(2),\n    color: theme.palette.text.secondary,\n    width: '100%',\n    height: '0px'\n  }\n}));\nconst customStyles = {\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)'\n  }\n};\n\nconst getMuiTheme = () => createMuiTheme({\n  overrides: {\n    MuiTableHead: {\n      root: {\n        position: 'sticky'\n      }\n    }\n  }\n});\n/**\r\n * Page d'affichage des annonces\r\n * @returns {*}\r\n * @constructor\r\n */\n\n\nfunction MyAnnoncesPage() {\n  _s();\n\n  const [data, setData] = useState([]); //produits de l'utilisateur\n\n  const [selectedAnnouncementId, setSelectedAnnouncementId] = useState(false); //announce de l'utilisateur ayant cliqué sur modifier\n\n  const [selectedAnnouncementIdToDelete, setSelectedAnnouncementIdToDelete] = useState(null);\n  const classes = useStyles();\n  const options = {\n    selectableRows: false,\n    textLabels: {\n      body: {\n        noMatch: 'Aucune annonce trouvée'\n      },\n      pagination: {\n        next: \"Page suivante\",\n        previous: \"Page précédente\",\n        rowsPerPage: \"Annonces par page:\",\n        displayRows: \"sur\"\n      }\n    }\n  };\n  const columns = [{\n    name: \"img\",\n    label: \"Image\",\n    options: {\n      customBodyRender: function (data) {\n        if (data) {\n          const dataImg = \"data:image/png;base64,\" + data;\n          return /*#__PURE__*/_jsxDEV(\"img\", {\n            src: dataImg,\n            width: 100\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 32\n          }, this);\n        } else return 'N/A';\n      }\n    }\n  }, {\n    name: \"title\",\n    label: \"Titre\"\n  }, {\n    name: \"price\",\n    label: \"Prix (€)\"\n  }, {\n    name: \"petName\",\n    label: \"Animal\"\n  }, {\n    name: \"date\",\n    label: \"Date de mise en ligne\"\n  }, {\n    name: \"vaccine\",\n    label: \"Vacciné\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"tattoue\",\n    label: \"Tattoué\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"puce\",\n    label: \"Pucé\",\n    options: {\n      customBodyRender: function (data) {\n        return /*#__PURE__*/_jsxDEV(Checkbox, {\n          checked: data,\n          disabled: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }, {\n    name: \"id\",\n    label: \"Actions\",\n    options: {\n      customBodyRender: function (res) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Editer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => {\n              setSelectedAnnouncementId(res);\n            },\n            children: /*#__PURE__*/_jsxDEV(EditOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            \"aria-label\": \"Supprimer\",\n            style: {\n              padding: \"3px\"\n            },\n            onClick: () => {\n              setSelectedAnnouncementIdToDelete(res);\n            },\n            children: /*#__PURE__*/_jsxDEV(DeleteOutlinedIcon, {\n              style: {\n                color: colors.grey\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 28\n        }, this);\n      }\n    }\n  }];\n  useEffect(() => {\n    refreshList();\n  }, []);\n  /**\r\n   * Arrangement des annonces pour l'insertion dans le tableau\r\n   * @param arr\r\n   */\n\n  function arrangeParameters(arr) {\n    var announcements = [];\n    arr.forEach(i => {\n      announcements.push({\n        'id': i.id,\n        'title': i.title,\n        'price': i.petAnnouncementInfo.price,\n        'petName': i.petAnnouncementInfo.pet.name,\n        'tattoue': i.petAnnouncementInfo.tattoo,\n        'vaccine': i.petAnnouncementInfo.vaccine,\n        'puce': i.petAnnouncementInfo.puce,\n        'date': i.date,\n        'img': i.image\n      });\n    });\n    setData(announcements);\n  }\n  /**\r\n   * Suppression d'une annonce\r\n   * @param id\r\n   */\n\n\n  function deleteAnnouncement(id) {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    mutation DeleteAnnouncementById($id: String!) {\n                      deleteAnnouncementById(id: $id){\n                          id\n                      }\n                    }`,\n        variables: {\n          \"id\": id\n        }\n      })\n    }).then(res => res.json()).then(function (result) {\n      refreshList();\n      setSelectedAnnouncementIdToDelete(null);\n    });\n  }\n  /**\r\n   * Récupère les annonces de l'utilisateur\r\n   */\n\n\n  function refreshList() {\n    fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        query: `\n                    query{​​​​​​​\n                        getAnnouncementsByUserId(id:\"${localStorage.getItem('userId')}\"){​​​​​​​    \n                            id\n                            title\n                            petAnnouncementInfo{\n                                pet{\n                                    name\n                                }\n                                price\n                                tattoo\n                                vaccine\n                                puce\n                            }\n                            image\n                            date\n                        }​​​​​​​\n                    }`\n      })\n    }).then(res => res.json()).then(function (result) {\n      arrangeParameters(result.data.getAnnouncementsByUserId);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [selectedAnnouncementId ? /*#__PURE__*/_jsxDEV(Redirect, {\n      to: {\n        pathname: \"/addAnnonce\",\n        state: {\n          announcementId: selectedAnnouncementId\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 21\n    }, this) : null, /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(Modal, {\n        isOpen: selectedAnnouncementIdToDelete !== null,\n        onRequestClose: () => setSelectedAnnouncementIdToDelete(null),\n        style: customStyles,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          children: \"Etes vous s\\xFBr de vouloir supprimer l'annonce?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => deleteAnnouncement(selectedAnnouncementIdToDelete),\n          children: \"Oui\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setSelectedAnnouncementIdToDelete(null),\n          children: \"Non\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Title, {\n        name: \"Mr.Adopt — Mes Annonces\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 5,\n        justify: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/annonces\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.brown\n            },\n            children: \"Mes annonces\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/addAnnonce\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Ajouter une annonce\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 3,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            component: Link,\n            to: \"/statisticsMrAdopt\",\n            className: classes.btn,\n            variant: \"contained\",\n            style: {\n              backgroundColor: colors.grey\n            },\n            children: \"Statistiques\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        mt: 5,\n        children: /*#__PURE__*/_jsxDEV(MuiThemeProvider, {\n          theme: getMuiTheme(),\n          children: /*#__PURE__*/_jsxDEV(MUIDataTable, {\n            title: \"Annonces\",\n            data: data,\n            columns: columns,\n            options: options,\n            spacing: 10\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 246,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyAnnoncesPage, \"5A9qrhuMpJcCj/V7Arn9llPH4Wk=\", false, function () {\n  return [useStyles];\n});\n\n_c = MyAnnoncesPage;\nexport default MyAnnoncesPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyAnnoncesPage\");","map":{"version":3,"sources":["C:/Users/PC/Desktop/BigNova-Projects/Project - 12 - BigNova-Pets Animals-web/ClonedFromGitHub/animals-pets/src/pages/MyAnnoncesPage.js"],"names":["React","useEffect","useState","Checkbox","makeStyles","Header","Title","Container","Grid","MUIDataTable","Button","Box","colors","DeleteOutlinedIcon","EditOutlinedIcon","IconButton","createMuiTheme","MuiThemeProvider","Link","Redirect","Modal","misterCoockyApi","useStyles","theme","root","flexGrow","btn","padding","spacing","color","palette","text","secondary","width","height","customStyles","content","top","left","right","bottom","marginRight","transform","getMuiTheme","overrides","MuiTableHead","position","MyAnnoncesPage","data","setData","selectedAnnouncementId","setSelectedAnnouncementId","selectedAnnouncementIdToDelete","setSelectedAnnouncementIdToDelete","classes","options","selectableRows","textLabels","body","noMatch","pagination","next","previous","rowsPerPage","displayRows","columns","name","label","customBodyRender","dataImg","res","grey","refreshList","arrangeParameters","arr","announcements","forEach","i","push","id","title","petAnnouncementInfo","price","pet","tattoo","vaccine","puce","date","image","deleteAnnouncement","fetch","method","headers","JSON","stringify","query","variables","then","json","result","localStorage","getItem","getAnnouncementsByUserId","pathname","state","announcementId","backgroundColor","brown"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport {Checkbox, makeStyles} from \"@material-ui/core\";\r\nimport {Header, Title} from \"../components\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport MUIDataTable from \"mui-datatables\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {colors} from \"../themes/colors\";\r\nimport DeleteOutlinedIcon from '@material-ui/icons/DeleteOutlined';\r\nimport EditOutlinedIcon from '@material-ui/icons/EditOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {createMuiTheme, MuiThemeProvider} from '@material-ui/core/styles';\r\nimport {Link, Redirect} from 'react-router-dom';\r\nimport Modal from 'react-modal';\r\nimport misterCoockyApi from '../constante/apiUrl'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        flexGrow: 1,\r\n    },\r\n    btn: {\r\n        padding: theme.spacing(2),\r\n        color: theme.palette.text.secondary,\r\n        width: '100%',\r\n        height: '0px',\r\n    },\r\n}));\r\nconst customStyles = {\r\n    content: {\r\n        top: '50%',\r\n        left: '50%',\r\n        right: 'auto',\r\n        bottom: 'auto',\r\n        marginRight: '-50%',\r\n        transform: 'translate(-50%, -50%)',\r\n    },\r\n};\r\nconst getMuiTheme = () => createMuiTheme({\r\n    overrides: {\r\n        MuiTableHead: {\r\n            root: {\r\n                position: 'sticky'\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Page d'affichage des annonces\r\n * @returns {*}\r\n * @constructor\r\n */\r\nfunction MyAnnoncesPage() {\r\n    const [data, setData] = useState([]);   //produits de l'utilisateur\r\n    const [selectedAnnouncementId, setSelectedAnnouncementId] = useState(false);   //announce de l'utilisateur ayant cliqué sur modifier\r\n    const [selectedAnnouncementIdToDelete, setSelectedAnnouncementIdToDelete] = useState(null);\r\n    const classes = useStyles();\r\n\r\n    const options = {\r\n        selectableRows: false,\r\n        textLabels: {\r\n            body: {\r\n                noMatch: 'Aucune annonce trouvée'\r\n            },\r\n            pagination: {\r\n                next: \"Page suivante\",\r\n                previous: \"Page précédente\",\r\n                rowsPerPage: \"Annonces par page:\",\r\n                displayRows: \"sur\",\r\n            },\r\n        }\r\n    };\r\n    const columns = [\r\n        {\r\n            name: \"img\",\r\n            label: \"Image\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    if (data) {\r\n                        const dataImg = \"data:image/png;base64,\" + data;\r\n                        return <img src={dataImg} width={100}/>;\r\n                    } else return 'N/A'\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"title\",\r\n            label: \"Titre\"\r\n        },\r\n        {\r\n            name: \"price\",\r\n            label: \"Prix (€)\"\r\n        },\r\n        {\r\n            name: \"petName\",\r\n            label: \"Animal\"\r\n        },\r\n        {\r\n            name: \"date\",\r\n            label: \"Date de mise en ligne\"\r\n        },\r\n        {\r\n            name: \"vaccine\",\r\n            label: \"Vacciné\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"tattoue\",\r\n            label: \"Tattoué\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"puce\",\r\n            label: \"Pucé\",\r\n            options: {\r\n                customBodyRender: function (data) {\r\n                    return <Checkbox checked={data} disabled={true}/>;\r\n                }\r\n            }\r\n        },\r\n        {\r\n            name: \"id\",\r\n            label: \"Actions\",\r\n            options: {\r\n                customBodyRender: function (res) {\r\n                    return <div>\r\n                        <IconButton aria-label=\"Editer\" style={{padding: \"3px\"}} onClick={() => {\r\n                            setSelectedAnnouncementId(res)\r\n                        }}>\r\n                            <EditOutlinedIcon style={{color: colors.grey}}/>\r\n                        </IconButton>\r\n                        <IconButton aria-label=\"Supprimer\" style={{padding: \"3px\"}} onClick={() => {\r\n                            setSelectedAnnouncementIdToDelete(res)\r\n                        }}>\r\n                            <DeleteOutlinedIcon style={{color: colors.grey}}/>\r\n                        </IconButton>\r\n                    </div>\r\n                }\r\n            }\r\n        },\r\n\r\n    ];\r\n\r\n    useEffect(() => {\r\n        refreshList()\r\n    }, []);\r\n\r\n    /**\r\n     * Arrangement des annonces pour l'insertion dans le tableau\r\n     * @param arr\r\n     */\r\n    function arrangeParameters(arr) {\r\n        var announcements = [];\r\n\r\n        arr.forEach(i => {\r\n            announcements.push({\r\n                'id': i.id,\r\n                'title': i.title,\r\n                'price': i.petAnnouncementInfo.price,\r\n                'petName': i.petAnnouncementInfo.pet.name,\r\n                'tattoue': i.petAnnouncementInfo.tattoo,\r\n                'vaccine': i.petAnnouncementInfo.vaccine,\r\n                'puce': i.petAnnouncementInfo.puce,\r\n                'date': i.date,\r\n                'img': i.image\r\n            })\r\n        });\r\n        setData(announcements)\r\n    }\r\n\r\n    /**\r\n     * Suppression d'une annonce\r\n     * @param id\r\n     */\r\n    function deleteAnnouncement(id) {\r\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                query: `\r\n                    mutation DeleteAnnouncementById($id: String!) {\r\n                      deleteAnnouncementById(id: $id){\r\n                          id\r\n                      }\r\n                    }`,\r\n                variables: {\r\n                    \"id\": id\r\n                }\r\n            }),\r\n        })\r\n            .then((res) => res.json())\r\n            .then(function (result) {\r\n                refreshList();\r\n                setSelectedAnnouncementIdToDelete(null)\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Récupère les annonces de l'utilisateur\r\n     */\r\n    function refreshList() {\r\n        fetch(`${misterCoockyApi.misterCoockyApi}/graphql`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                query: `\r\n                    query{​​​​​​​\r\n                        getAnnouncementsByUserId(id:\"${localStorage.getItem('userId')}\"){​​​​​​​    \r\n                            id\r\n                            title\r\n                            petAnnouncementInfo{\r\n                                pet{\r\n                                    name\r\n                                }\r\n                                price\r\n                                tattoo\r\n                                vaccine\r\n                                puce\r\n                            }\r\n                            image\r\n                            date\r\n                        }​​​​​​​\r\n                    }`,\r\n            }),\r\n        })\r\n            .then((res) => res.json())\r\n            .then(function (result) {\r\n                arrangeParameters(result.data.getAnnouncementsByUserId);\r\n            })\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                selectedAnnouncementId ?\r\n                    <Redirect\r\n                        to={{\r\n                            pathname: \"/addAnnonce\",\r\n                            state: {announcementId: selectedAnnouncementId}\r\n                        }}\r\n                    /> : null\r\n            }\r\n\r\n            <Header/>\r\n            <Container>\r\n                <Modal\r\n                    isOpen={selectedAnnouncementIdToDelete !== null}\r\n                    onRequestClose={() => setSelectedAnnouncementIdToDelete(null)}\r\n                    style={customStyles}\r\n                >\r\n                    <Grid>Etes vous sûr de vouloir supprimer l'annonce?</Grid>\r\n                    <Button onClick={() => deleteAnnouncement(selectedAnnouncementIdToDelete)}>Oui</Button>\r\n                    <Button onClick={() => setSelectedAnnouncementIdToDelete(null)}>Non</Button>\r\n                </Modal>\r\n                <Title name={\"Mr.Adopt — Mes Annonces\"}/>\r\n                <Grid container spacing={5} justify=\"center\">\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/annonces\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.brown}}>Mes annonces</Button>\r\n                    </Grid>\r\n\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/addAnnonce\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.grey}}>Ajouter une annonce</Button>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={3}>\r\n                        <Button component={Link} to=\"/statisticsMrAdopt\" className={classes.btn} variant=\"contained\"\r\n                                style={{backgroundColor: colors.grey}}>Statistiques</Button>\r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <Box mt={5}>\r\n                    <MuiThemeProvider theme={getMuiTheme()}>\r\n                        <MUIDataTable\r\n                            title={\"Annonces\"}\r\n                            data={data}\r\n                            columns={columns}\r\n                            options={options}\r\n                            spacing={10}\r\n                        />\r\n                    </MuiThemeProvider>\r\n                </Box>\r\n            </Container>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default MyAnnoncesPage\r\n"]},"metadata":{},"sourceType":"module"}